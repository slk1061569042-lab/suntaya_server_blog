# 部署方案说明

## 📋 概述

本项目是一个 Next.js 应用，支持多种部署方式。本文档说明各种部署方案的配置和使用方法。

## 🎯 我的能力范围

### ✅ 我可以做什么
1. **本地编辑和推送**
   - 在本地项目目录中编辑文件
   - 使用 Git 命令提交和推送到 GitHub
   - 工作流程：本地编辑 → `git add` → `git commit` → `git push`

2. **自动化配置**
   - 创建 GitHub Actions 工作流
   - 创建 Jenkins 配置文件
   - 编写部署脚本

### ❌ 我不能做什么
1. **不能直接在 GitHub 网页上编辑**
   - 我无法直接操作 GitHub 网页界面
   - 所有编辑都在本地完成，然后推送到 GitHub

2. **不能直接操作服务器**
   - 需要你提供服务器访问权限
   - 我可以提供配置文件和脚本，但需要你在服务器上执行

## 🚀 部署方案

### 方案一：GitHub Actions（推荐）

GitHub Actions 是 GitHub 内置的 CI/CD 平台，完全免费（有限额），无需额外服务器。

#### 优点
- ✅ 完全免费（公开仓库无限使用，私有仓库有免费额度）
- ✅ 无需额外服务器
- ✅ 配置简单，直接在仓库中配置
- ✅ 自动触发（push 代码自动构建和部署）

#### 已创建的配置
- 文件位置：`.github/workflows/deploy.yml`
- 功能：自动构建、测试、部署

#### 使用步骤
1. **推送到 GitHub**（已完成）
2. **配置 Secrets**（如果需要部署到 Vercel）：
   - 进入 GitHub 仓库 → Settings → Secrets and variables → Actions
   - 添加 `VERCEL_TOKEN`、`VERCEL_ORG_ID`、`VERCEL_PROJECT_ID`

3. **自动运行**
   - 每次 push 到 main 分支会自动触发构建

### 方案二：Jenkins 自动部署

Jenkins 是开源的 CI/CD 工具，需要在你的服务器上安装。

#### 优点
- ✅ 完全控制部署流程
- ✅ 可以部署到自己的服务器
- ✅ 支持复杂的部署流程
- ✅ 可以集成其他工具

#### 配置步骤

##### 1. 在 GitHub 配置 Webhook

1. 进入 GitHub 仓库 → Settings → Webhooks → Add webhook
2. 配置：
   - **Payload URL**: `http://your-jenkins-server:8080/github-webhook/`
   - **Content type**: `application/json`
   - **Events**: 选择 `Just the push event`
   - **Active**: ✅ 勾选

##### 2. 在 Jenkins 创建任务

我已经为你创建了 Jenkinsfile，位置：`Jenkinsfile`

在 Jenkins 中：
1. 新建任务 → 选择 "流水线"（Pipeline）
2. 在 "流水线" 部分：
   - **定义**: Pipeline script from SCM
   - **SCM**: Git
   - **Repository URL**: 你的 GitHub 仓库 URL
   - **Credentials**: 添加 GitHub 访问凭证
   - **分支**: `*/main`
   - **脚本路径**: `Jenkinsfile`

##### 3. Jenkinsfile 说明

Jenkinsfile 包含以下步骤：
- 检出代码
- 安装 Node.js
- 安装依赖
- 运行测试
- 构建项目
- 部署到服务器（需要配置服务器信息）

### 方案三：Vercel（Next.js 官方平台）

Vercel 是 Next.js 的创建者提供的部署平台，对 Next.js 支持最好。

#### 优点
- ✅ Next.js 官方推荐
- ✅ 零配置部署
- ✅ 自动 HTTPS
- ✅ 全球 CDN
- ✅ 免费额度充足

#### 使用步骤

##### 方法一：通过 GitHub 集成（最简单）

1. 访问 [vercel.com](https://vercel.com)
2. 使用 GitHub 账号登录
3. 点击 "Add New Project"
4. 选择你的 GitHub 仓库
5. 点击 "Deploy"
6. 完成！每次 push 代码会自动部署

##### 方法二：通过 GitHub Actions

已配置在 `.github/workflows/deploy.yml` 中，需要配置 Secrets。

### 方案四：GitHub Pages（静态网站）

GitHub Pages 只能部署静态网站，Next.js 需要配置静态导出。

#### 限制
- ❌ 只能部署静态网站
- ❌ 不支持服务端功能（API routes）
- ❌ 需要修改 `next.config.ts` 启用静态导出

#### 如果需要使用

1. 修改 `next.config.ts`：
```typescript
const nextConfig: NextConfig = {
  output: 'export', // 启用静态导出
  // 其他配置...
};
```

2. 使用 GitHub Actions 自动部署（已配置，但被注释）

## 📊 方案对比

| 方案 | 难度 | 成本 | 适用场景 |
|------|------|------|----------|
| GitHub Actions | ⭐ 简单 | 免费 | 快速部署，适合大多数项目 |
| Jenkins | ⭐⭐⭐ 复杂 | 服务器成本 | 需要完全控制，企业级部署 |
| Vercel | ⭐ 非常简单 | 免费 | Next.js 项目首选 |
| GitHub Pages | ⭐⭐ 中等 | 免费 | 静态网站，不支持服务端功能 |

## 🔧 推荐方案

### 对于你的项目

**推荐组合**：
1. **主要部署**：Vercel（最简单，Next.js 官方支持）
2. **备用方案**：GitHub Actions + 你的服务器（如果需要完全控制）

### 快速开始

#### 使用 Vercel（推荐）

1. 访问 https://vercel.com
2. 用 GitHub 登录
3. 导入你的仓库
4. 点击 Deploy
5. 完成！

#### 使用 Jenkins

1. 确保服务器已安装 Jenkins
2. 配置 GitHub Webhook
3. 在 Jenkins 中创建 Pipeline 任务
4. 使用项目中的 `Jenkinsfile`

## 📝 下一步

1. **选择部署方案**
2. **如果需要 Jenkins**：
   - 我可以帮你创建更详细的 Jenkins 配置
   - 可以创建部署脚本
3. **如果需要 Vercel**：
   - 直接访问 vercel.com 导入仓库即可
4. **如果需要自定义部署**：
   - 告诉我你的服务器信息，我可以创建对应的配置

## 🆘 需要帮助？

告诉我你选择的部署方案，我可以：
- 创建详细的配置文档
- 编写部署脚本
- 提供故障排查指南
